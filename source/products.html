{% assign pageQuerystring = page.full_url | split:'sort=' | last %}

{% if pageQuerystring == 'newest' %}
  {% assign sort_order = 'newest' %}
{% elsif pageQuerystring == 'top_selling' %}
  {% assign sort_order = 'top_selling' %}
{% elsif pageQuerystring == 'most_viewed' %}
  {% assign sort_order = 'most_viewed' %}
{% elsif pageQuerystring == '' %}
  {% assign sort_order = pageQuerystring %}
{% endif %}

<div class="page-heading has-sorting">
  <h1 class="page-title">{{ page.name }}</h1>
  <div class="product-sort">
    <div class="product-sort-caption">Sort by</div>
    <div class="select product-sort-options">
      <select class="product-sort-options-select">
        <option value="default"{% if sort_order == '' %} selected="selected"{% endif %}>Featured</option>
        <option value="top_selling"{% if sort_order == 'on_sale' %} selected="selected"{% endif %}>On sale</option>
        <option value="top_selling"{% if sort_order == 'top_selling' %} selected="selected"{% endif %}>Top selling</option>
        <option value="newest"{% if sort_order == 'title-ascending' %} selected="selected"{% endif %}>Alphabetically (A to Z)</option>
        <option value="newest"{% if sort_order == 'title-descending' %} selected="selected"{% endif %}>Alphabetically (Z to A)</option>

        <option value="newest"{% if sort_order == 'date-ascending' %} selected="selected"{% endif %}>Date (new to old)</option>
        <option value="newest"{% if sort_order == 'date-descending' %} selected="selected"{% endif %}>Date (old to new)</option>

        <option value="newest"{% if sort_order == 'price-ascending' %} selected="selected"{% endif %}>Price (low to high)</option>
        <option value="newest"{% if sort_order == 'price-descending' %} selected="selected"{% endif %}>Price (high to low)</option>

      </select>
      <svg aria-hidden="true" width="10" height="8" viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M5.52498072 7.00937603l4.24998987-4.24998987c.29376151-.2906182.29376151-.76562318 0-1.05935416L9.06873448.99376537c-.2906182-.29373099-.76562317-.29373099-1.05938468 0L4.99687529 4.00627039 1.98437027.99376537c-.2906182-.29373099-.76562318-.29373099-1.05938468 0L.21874948 1.700032c-.2937615.2906182-.2937615.76562317 0 1.05935416l4.24998987 4.24998987c.2937615.2937615.76873596.2937615 1.05624137 0z" fill-rule="nonzero"/></svg>
    </div>
  </div>
</div>


{% paginate products from products.current by theme.products_per_page order: sort_order %}
  {% if products != blank %}
    <div class="product-list-container">
      <div class="product-list {{ theme.product_list_layout }} mobile-{{ theme.mobile_product_grid_style }} {% if theme.layout_style == 'full_width' %}grid-full-width{% endif %}">
        {% for product in products %}
          {% assign product_status = '' %}
          {% case product.status %}
            {% when 'active' %}
              {% if product.on_sale %}{% assign product_status = 'On sale' %}{% endif %}
            {% when 'sold-out' %}
              {% assign product_status = 'Sold out' %}
            {% when 'coming-soon' %}
              {% assign product_status = 'Coming soon' %}
          {% endcase %}
          {% capture image_class %}
            {% if product.image.height > product.image.width %}
              image-tall
            {% elsif product.image.height < product.image.width %}
              image-wide
            {% else %}
              image-square
            {% endif %}
          {% endcapture %}
          <a class="product-list-item product-image-{{ theme.product_grid_image_size }} {{ theme.show_overlay }} {{ theme.grid_image_style }} {% if theme.show_quickview %}show-quickview{% endif %}" href="{{ product.url }}" title="View {{ product.name | escape }}">
            <div class="product-list-item-container">
              <figure class="product-list-image-container">
                <img alt="" class="lazy product-list-image {{ image_class }}" src="{{ product.image | product_image_url | constrain: 50 }}" data-src="{{ product.image | product_image_url | constrain: 1000 }}" data-srcset="{{ product.image | product_image_url | constrain: 2000 }} 2x, {{ product.image | product_image_url | constrain: 1000 }} 1x">
                {% if product_status != blank and theme.product_badge_style != 'inline' %}<div class="product-list-item-status {{ theme.product_badge_style }}">{{ product_status }}</div>{% endif %}
                {% if theme.show_quickview %}
                  <div class="product-list-quickview-container">
                    <div class="product-list-quickview-container-background"></div>
                    <button class="open-quickview" data-permalink="{{ product.permalink }}" data-has-default="{{ product.has_default_option }}">
                      <span class="open-quickview-text">Quick View</span>
                      <svg aria-hidden="true" class="open-quickview-icon" width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M2 5.00001907V2.00003099h2.99998808v-2H0v4.99998808h2zm11.9999785 0V.00003099H8.99997854v2h2.99999996v2.99998808h2zm0 8.99997853V9.00000954h-2v2.99999996H8.99997854v1.9999881h4.99999996zm-8.99999042 0v-1.9999881H2V9.00000954H0v4.99998806h4.99998808z" fill-rule="nonzero"/></svg>
                    </button>
                  </div>
                {% endif %}
              </figure>
            </div>
            <div class="product-list-item-info">
              <div class="product-list-item-background"></div>
              <div class="product-list-item-info-headers">
                <div class="product-list-item-name">{{ product.name }}</div>
                <div class="product-list-item-price">{{ product.default_price | money: theme.money_format }}</div>
                {% if product_status != blank and theme.product_badge_style == 'inline' %}<div class="product-list-item-status {{ theme.product_badge_style }}">{{ product_status }}</div>{% endif %}
              </div>
            </div>
          </a>
        {% endfor %}
      </div>
    </div>
    {% if paginate.pages > 1 %}
      {{ paginate | default_pagination, 'pagination', 'pagination', '<svg aria-hidden="true" width="12" height="20" viewBox="0 0 12 20" xmlns="http://www.w3.org/2000/svg"><path fill="#000" d="M0 9.99663714L9.99663714 0l1.87436946 1.87436946-8.12548453 8.12608504 8.12548453 8.125176L9.99663714 20 0 10.0033629l.00353434-.0029084z" fill-rule="evenodd"/></svg>', '<svg aria-hidden="true" width="12" height="20" viewBox="0 0 12 20" xmlns="http://www.w3.org/2000/svg"><path fill="#000" d="M11.871006 9.99663714L1.87436886 0-6e-7 1.87436946l8.12548453 8.12608504L-6e-7 18.1256305 1.87436886 20l9.99663714-9.9966371-.00353434-.0029084z" fill-rule="evenodd"/></svg>' }}
    {% endif %}
  {% else %}
    <div class="empty-products centered-message">No products found.</div>
  {% endif %}
{% endpaginate %}